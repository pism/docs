
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Surface mass and energy process model components &#8212; PISM, a Parallel Ice Sheet Model 2.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"dx": "\\Delta x", "dy": "\\Delta y", "dz": "\\Delta z", "dt": "\\Delta t", "km": "\\,\\text{km}", "Diff": [" \\frac{\\mathrm{d}#1}{\\mathrm{d}#2} ", "2"], "diff": [" \\frac{\\partial #1}{\\partial #2} ", "2"], "var": [" {#1}_{\\text{#2}} ", "2"], "h": [" \\var{h}{#1} ", "1"], "T": [" \\var{T}{#1} ", "1"], "m": [" \\var{m}{#1} ", "1"], "ms": [" \\var{m^{*}}{#1} ", "1"], "psw": "p_{\\text{water}}", "pice": "p_{\\text{ice}}", "pmelange": "\\bar p_{\\text{melange}}", "rhoi": "\\rho_{\\text{ice}}", "rhow": "\\rho_{\\text{water}}", "n": "\\boldsymbol{n}", "nx": "\\n_{x}", "ny": "\\n_{y}", "phimin": "\\phi_{\\mathrm{min}}", "phimax": "\\phi_{\\mathrm{max}}", "bmin": "b_{\\mathrm{min}}", "bmax": "b_{\\mathrm{max}}", "bq": "\\mathbf{q}", "Up": ["\\operatorname{Up}\\left(#1\\big|#2\\right)", "2"], "uppair": ["\\left\\{\\begin{matrix} #1 \\\\ #2 \\end{matrix}\\right\\}", "2"], "Div": "\\nabla \\cdot", "V": "\\mathbf{V}", "Wtill": "W_{\\mathrm{till}}", "zs": "z_{\\text{sea level}}", "uu": "\\boldsymbol{u}", "nz": "\\n_{z}", "td": ["t^{D}_{#1}", "1"], "D": "\\displaystyle", "viscosity": "\\nu", "partI": "(2\\tilde N_{xx} + \\tilde N_{yy})", "partII": "(\\tilde N_{xy})", "E": "\\dot{\\boldsymbol{\\epsilon}}", "exponent": "\\frac{1-n}{2n}", "p": ["\\left(#1\\right)", "1"], "f": "\\rho\\, g\\, \\nabla s", "Id": "\\int_{\\Omega}", "Ib": "\\int_{\\partial\\Omega}", "Ibase": "\\int_{\\text{base}}", "dphi": ["\\diff{\\varphi_{#1}}{#2}", "2", "i"], "dpsi": ["\\diff{\\psi_{#1}}{#2}", "2", "i"], "Hmin": "H_{\\text{min}}", "dbeta": "\\diff{\\beta}{\\alpha}", "K": ["K_{i,j,#1,#2}", "2"], "ELA": "h_{\\text{ELA}}", "dphimin": "\\Delta \\phi_{\\mathrm{min}}", "dphimax": "\\Delta \\phi_{\\mathrm{max}}"}}}</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Atmosphere model components" href="atmosphere.html" />
    <link rel="prev" title="Testing if forcing data is used correctly" href="testing.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
<div class="documentwrapper">
  <div class="bodywrapper">
    <div class="body" role="main">
      
  <section id="surface-mass-and-energy-process-model-components">
<h1><a class="toc-backref" href="#id45">Surface mass and energy process model components</a><a class="headerlink" href="#surface-mass-and-energy-process-model-components" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#surface-mass-and-energy-process-model-components" id="id45">Surface mass and energy process model components</a></p>
<ul>
<li><p><a class="reference internal" href="#the-invisible-model" id="id46">The “invisible” model</a></p></li>
<li><p><a class="reference internal" href="#reading-top-surface-boundary-conditions-from-a-file" id="id47">Reading top-surface boundary conditions from a file</a></p></li>
<li><p><a class="reference internal" href="#elevation-dependent-temperature-and-mass-balance" id="id48">Elevation-dependent temperature and mass balance</a></p></li>
<li><p><a class="reference internal" href="#temperature-index-scheme" id="id49">Temperature-index scheme</a></p></li>
<li><p><a class="reference internal" href="#diurnal-energy-balance-model-debm-simple" id="id50">Diurnal Energy Balance Model “dEBM-simple”</a></p>
<ul>
<li><p><a class="reference internal" href="#insolation-driven-melt-contribution" id="id51">Insolation-driven melt contribution</a></p>
<ul>
<li><p><a class="reference internal" href="#mean-top-of-the-atmosphere-insolation" id="id52">Mean top of the atmosphere insolation</a></p></li>
<li><p><a class="reference internal" href="#surface-albedo" id="id53">Surface albedo</a></p></li>
<li><p><a class="reference internal" href="#atmosphere-transmissivity" id="id54">Atmosphere transmissivity</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#temperature-driven-melt-contribution" id="id55">Temperature-driven melt contribution</a></p></li>
<li><p><a class="reference internal" href="#tuning-parameters" id="id56">Tuning parameters</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#pik" id="id57">PIK</a></p></li>
<li><p><a class="reference internal" href="#scalar-temperature-offsets" id="id58">Scalar temperature offsets</a></p></li>
<li><p><a class="reference internal" href="#adjustments-using-modeled-change-in-surface-elevation" id="id59">Adjustments using modeled change in surface elevation</a></p></li>
<li><p><a class="reference internal" href="#mass-flux-adjustment" id="id60">Mass flux adjustment</a></p></li>
<li><p><a class="reference internal" href="#using-climate-data-anomalies" id="id61">Using climate data anomalies</a></p></li>
<li><p><a class="reference internal" href="#the-caching-modifier" id="id62">The caching modifier</a></p></li>
<li><p><a class="reference internal" href="#preventing-grounding-line-retreat" id="id63">Preventing grounding line retreat</a></p></li>
</ul>
</li>
</ul>
</div>
<section id="the-invisible-model">
<span id="sec-surface-simple"></span><h2><a class="toc-backref" href="#id46">The “invisible” model</a><a class="headerlink" href="#the-invisible-model" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">-surface</span> <span class="pre">simple</span></code></p>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><p>none</p>
</dd>
<dt class="field-odd">C++ class</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">pism::surface::Simple</span></code></p>
</dd>
</dl>
<p>This is the simplest “surface model” available in PISM, enabled using <code class="docutils literal notranslate"><span class="pre">-surface</span> <span class="pre">simple</span></code>.
Its job is to re-interpret precipitation as climatic mass balance, and to re-interpret
mean annual near-surface (2m) air temperature as the temperature of the ice at the depth
at which firn processes cease to change the temperature of the ice. (I.e. the temperature
<em>below</em> the firn.) This implies that there is no melt. Though primitive, this model
component may be desired in cold environments (e.g. East Antarctic ice sheet) in which
melt is negligible and heat from firn processes is ignored.</p>
</section>
<section id="reading-top-surface-boundary-conditions-from-a-file">
<span id="sec-surface-given"></span><h2><a class="toc-backref" href="#id47">Reading top-surface boundary conditions from a file</a><a class="headerlink" href="#reading-top-surface-boundary-conditions-from-a-file" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">-surface</span> <span class="pre">given</span></code></p>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><p><code class="variable docutils literal notranslate"><span class="pre">ice_surface_temp</span></code>, <code class="variable docutils literal notranslate"><span class="pre">climatic_mass_balance</span></code> <span class="math notranslate nohighlight">\(kg / (m^{2} s)\)</span></p>
</dd>
<dt class="field-odd">C++ class</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">pism::surface::Given</span></code></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is the default choice.</p>
</div>
<p>This model component was created to force PISM with sampled (possibly periodic) climate
data by reading ice upper surface boundary conditions from a file. These fields are
provided directly to the ice dynamics code (see <a class="reference internal" href="../manual/highlevelview/climate-inputs.html#sec-climate-inputs"><span class="std std-ref">Climate inputs, and their interface with ice dynamics</span></a> for details).</p>
<p>PISM will stop if variables <code class="variable docutils literal notranslate"><span class="pre">ice_surface_temp</span></code> (ice temperature at the ice surface
but below firn) and <code class="variable docutils literal notranslate"><span class="pre">climatic_mass_balance</span></code> (top surface mass flux into the ice) are
not present in the input file.</p>
<p>A file <code class="docutils literal notranslate"><span class="pre">foo.nc</span></code> used with <code class="docutils literal notranslate"><span class="pre">-surface</span> <span class="pre">given</span> <span class="pre">-surface_given_file</span> <span class="pre">foo.nc</span></code> may contain
several records. If this file contains one record (i.e. fields corresponding to one time
value only), provided forcing data is interpreted as time-independent. Variables
<code class="variable docutils literal notranslate"><span class="pre">time</span></code> and <code class="variable docutils literal notranslate"><span class="pre">time_bnds</span></code> should specify model times corresponding to individual
records.</p>
<p>For example, to use monthly periodic forcing with a period of 1 year starting at the
beginning of <span class="math notranslate nohighlight">\(1980\)</span> (let’s use the <span class="math notranslate nohighlight">\(360\)</span>-day calendar for simplicity), create a file
(say, “<code class="docutils literal notranslate"><span class="pre">foo.nc</span></code>”) with 12 records. The <code class="variable docutils literal notranslate"><span class="pre">time</span></code> variable may contain <span class="math notranslate nohighlight">\(15, 45, 75,
\dots, 345\)</span> (mid-month for all <span class="math notranslate nohighlight">\(12\)</span> months) and have the units of “<code class="docutils literal notranslate"><span class="pre">days</span> <span class="pre">since</span>
<span class="pre">1980-1-1</span></code>”. (It is best to avoid units of “months” and “years” because their meanings
depend on the calendar.) Next, add the <code class="variable docutils literal notranslate"><span class="pre">time_bounds</span></code> variable for the time dimension
with the values <span class="math notranslate nohighlight">\(0, 30, 30, 60, \dots\)</span> specifying times corresponding to beginnings and
ends of records for each month and set the <code class="docutils literal notranslate"><span class="pre">time:bounds</span></code> attribute accordingly. Now run</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pismr -surface given -surface_given_file foo.nc -surface.given.periodic
</pre></div>
</div>
<p>See <a class="reference internal" href="time-dependent.html#sec-forcing-time-dependent"><span class="std std-ref">Using time-dependent forcing</span></a> for more information.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li><p>This surface model <em>ignores</em> the atmosphere model selection made using the option
<code class="option docutils literal notranslate"><span class="pre">-atmosphere</span></code>.</p></li>
<li><p>PISM can handle files with virtually any number of records: it will read and store in
memory at most <a class="reference internal" href="../manual/parameters/index.html#config-input.forcing.buffer_size"><code class="docutils literal notranslate"><span class="pre">input</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.forcing</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.buffer_size</span></code></a> records at any given time
(default: 60, or 5 years’ worth of monthly fields).</p></li>
<li><p>when preparing a file for use with this model, it is best to use the <code class="docutils literal notranslate"><span class="pre">t,y,x</span></code>
variable storage order: files using this order can be read in faster than ones using
the <code class="docutils literal notranslate"><span class="pre">t,x,y</span></code> order, for reasons <a class="reference internal" href="../manual/practical-usage/input-output.html#sec-pism-io-performance"><span class="std std-ref">explained in the User’s Manual</span></a>.</p>
<p>To change the storage order in a NetCDF file, use <code class="docutils literal notranslate"><span class="pre">ncpdq</span></code>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ncpdq -a t,y,x input.nc output.nc
</pre></div>
</div>
<p>will copy data from <code class="docutils literal notranslate"><span class="pre">input.nc</span></code> into <code class="docutils literal notranslate"><span class="pre">output.nc</span></code>, changing the storage order to
<code class="docutils literal notranslate"><span class="pre">t,y,x</span></code> at the same time.</p>
</li>
</ul>
</div>
<p class="rubric">Parameters</p>
<p>Prefix: <code class="docutils literal notranslate"><span class="pre">surface.given.</span></code></p>
<ol class="simple">
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.given.file"><code class="docutils literal notranslate"><span class="pre">file</span></code></a> Name of the file containing climate forcing fields.</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.given.periodic"><code class="docutils literal notranslate"><span class="pre">periodic</span></code></a> (no) If true, interpret forcing data as periodic in time</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.given.smb_max"><code class="docutils literal notranslate"><span class="pre">smb_max</span></code></a> (91000<em> kg m-2 year-1</em>) Maximum climatic mass balance value (used to check input data). Corresponds to 100 m/year ice equivalent.</p></li>
</ol>
</section>
<section id="elevation-dependent-temperature-and-mass-balance">
<span id="sec-surface-elevation"></span><h2><a class="toc-backref" href="#id48">Elevation-dependent temperature and mass balance</a><a class="headerlink" href="#elevation-dependent-temperature-and-mass-balance" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">-surface</span> <span class="pre">elevation</span></code></p>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><p>none</p>
</dd>
<dt class="field-odd">C++ class</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">pism::surface::Elevation</span></code></p>
</dd>
</dl>
<p>This surface model component parameterizes the ice surface temperature <span class="math notranslate nohighlight">\(T_{h}\)</span> =
<code class="variable docutils literal notranslate"><span class="pre">ice_surface_temp</span></code> and the mass balance <span class="math notranslate nohighlight">\(m\)</span> = <code class="variable docutils literal notranslate"><span class="pre">climatic_mass_balance</span></code> as
<em>piecewise-linear</em> functions of surface elevation <span class="math notranslate nohighlight">\(h\)</span>.</p>
<p>The option <code class="option docutils literal notranslate"><span class="pre">-ice_surface_temp</span></code> (<em>list of 4 numbers</em>) determines the surface
temperature using the 4 parameters <span class="math notranslate nohighlight">\(\T{min}\)</span>, <span class="math notranslate nohighlight">\(\T{max}\)</span>, <span class="math notranslate nohighlight">\(\h{min}\)</span>,
<span class="math notranslate nohighlight">\(\h{max}\)</span>. Let</p>
<div class="math notranslate nohighlight">
\[\diff{T}{h} = (\T{max} - \T{min}) / (\h{max} - \h{min})\]</div>
<p>be the temperature gradient. Then</p>
<div class="math notranslate nohighlight">
\[\begin{split}T(x,y) =
\begin{cases}
  \T{min}, &amp; h(x,y) \le \h{min}, \\
  \T{min} + \diff{T}{h} \, (h(x,y) - \h{min}), &amp; \h{min} &lt; h(x,y) &lt; \h{max}, \\
  \T{max}, &amp; \h{max} \le h(x,y).
\end{cases}\end{split}\]</div>
<p>The option <code class="option docutils literal notranslate"><span class="pre">-climatic_mass_balance</span></code> (<em>list of 5 numbers</em>) determines the surface mass
balance using the 5 parameters <span class="math notranslate nohighlight">\(\m{min}\)</span>, <span class="math notranslate nohighlight">\(\m{max}\)</span>, <span class="math notranslate nohighlight">\(\h{min}\)</span>,
<span class="math notranslate nohighlight">\(\h{ELA}\)</span>, <span class="math notranslate nohighlight">\(\h{max}\)</span>. Let</p>
<div class="math notranslate nohighlight">
\[\diff{\m{abl}}{h} = -\m{min} / (\ELA - \h{min})\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\diff{\m{acl}}{h} = \m{max} / (\h{max} - \ELA)\]</div>
<p>be the mass balance gradient in the ablation and in the accumulation area, respectively.
Then</p>
<div class="math notranslate nohighlight">
\[\begin{split}m(x,y) =
\begin{cases}
 \m{min}, &amp; h(x,y) \le \h{min}, \\
 \diff{\m{abl}}{h} \, (h(x,y) - \ELA), &amp; \h{min} &lt; h(x,y) \le \ELA, \\
 \diff{\m{acl}}{h} \, (h(x,y) - \ELA), &amp; \ELA &lt; h(x,y) \le \h{max}, \\
 \m{max}, &amp; \h{max} &lt; h(x,y).
\end{cases}\end{split}\]</div>
<p>The option <code class="option docutils literal notranslate"><span class="pre">-climatic_mass_balance_limits</span></code> (<em>list of 2 numbers</em>) limits the mass
balance below <span class="math notranslate nohighlight">\(\h{min}\)</span> to <span class="math notranslate nohighlight">\(\ms{min}\)</span> and above <span class="math notranslate nohighlight">\(\h{max}\)</span> to
<span class="math notranslate nohighlight">\(\ms{max}\)</span>, thus</p>
<div class="math notranslate nohighlight">
\[\begin{split}m(x,y) =
\begin{cases}
 m^{*}_{\text{min}}, &amp; h(x,y) \le \h{min}, \\
 \diff{\m{abl}}{h} \, (h(x,y) - \ELA), &amp; \h{min} &lt; h(x,y) \le \ELA, \\
 \diff{\m{acl}}{h} \, (h(x,y) - \ELA), &amp; \ELA &lt; h(x,y) \le \h{max}, \\
 m^{*}_{\text{max}}, &amp; \h{max} &lt; h(x,y).
\end{cases}\end{split}\]</div>
<p>Note: this surface model <em>ignores</em> the atmosphere model selection made using the
<code class="option docutils literal notranslate"><span class="pre">-atmosphere</span></code> option.</p>
</section>
<section id="temperature-index-scheme">
<span id="sec-surface-pdd"></span><h2><a class="toc-backref" href="#id49">Temperature-index scheme</a><a class="headerlink" href="#temperature-index-scheme" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">-surface</span> <span class="pre">pdd</span></code></p>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><p><code class="variable docutils literal notranslate"><span class="pre">air_temp_sd</span></code>, <code class="variable docutils literal notranslate"><span class="pre">snow_depth</span></code></p>
</dd>
<dt class="field-odd">C++ class</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">pism::surface::TemperatureIndex</span></code></p>
</dd>
</dl>
<p>The default PDD model used by PISM, turned on by option <code class="option docutils literal notranslate"><span class="pre">-surface</span> <span class="pre">pdd</span></code>, is based on
<span id="id1">[<a class="reference internal" href="../zzz_references_html.html#id96" title="Reinhard Calov and Ralf Greve. Correspondence: A semi-analytical solution for the positive degree-day model with stochastic temperature variations. J. Glaciol, 51(172):173–175, 2005.">153</a>]</span> and EISMINT-Greenland intercomparison (see <span id="id2">[<a class="reference internal" href="../zzz_references_html.html#id386" title="C. Ritz. EISMINT Intercomparison Experiment: Comparison of existing Greenland models. 1997. URL: https://web.archive.org/web/20220120054655/http://homepages.vub.ac.be/~phuybrec/eismint/greenland.html.">148</a>]</span>).</p>
<p>Our model computes the solid (snow) precipitation rate using the air temperature threshold
with a linear transition. All precipitation during periods with air temperatures above
<a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.air_temp_all_precip_as_rain"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.pdd</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.air_temp_all_precip_as_rain</span></code></a> (default of <span class="math notranslate nohighlight">\(2^\circ C\)</span>) is interpreted as
rain; all precipitation during periods with air temperatures below
<a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.air_temp_all_precip_as_snow"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.pdd</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.air_temp_all_precip_as_snow</span></code></a> (default of <span class="math notranslate nohighlight">\(0^\circ C\)</span>) is interpreted as
snow.</p>
<p>For long-term simulations, a PDD model generally uses an idealized seasonal temperature
cycle. “White noise” is added to this cycle to simulate additional daily variability
associated to the vagaries of weather. This additional random variation is quite
significant, as the seasonal cycle may never reach the melting point but that point may be
reached with some probability, in the presence of the daily variability, and thus melt may
occur. Concretely, a normally-distributed, mean zero random temperature increment is added
to the seasonal cycle. There is no assumed spatial correlation of daily variability. The
standard deviation of the daily variability is controlled by configuration parameters with
the prefix <code class="docutils literal notranslate"><span class="pre">surface.pdd.std_dev.</span></code>:</p>
<ol class="simple">
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.std_dev.file"><code class="docutils literal notranslate"><span class="pre">file</span></code></a> The name of the file to read <code class="docutils literal notranslate"><span class="pre">air_temp_sd</span></code> (standard deviation of air temperature) from.</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.std_dev.lapse_lat_base"><code class="docutils literal notranslate"><span class="pre">lapse_lat_base</span></code></a> (72<em> degree_north</em>) standard deviationis is a function of latitude, with value <a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.std_dev.value"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.pdd</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.std_dev</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.value</span></code></a> at this latitude; this value is only active if <a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.std_dev.lapse_lat_rate"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.pdd</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.std_dev</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.lapse_lat_rate</span></code></a> is nonzero</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.std_dev.lapse_lat_rate"><code class="docutils literal notranslate"><span class="pre">lapse_lat_rate</span></code></a> (0<em> Kelvin / degree_north</em>) standard deviation is a function of latitude, with rate of change with respect to latitude given by this constant</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.std_dev.param_a"><code class="docutils literal notranslate"><span class="pre">param_a</span></code></a> (-0.15) Parameter <span class="math notranslate nohighlight">\(a\)</span> in <span class="math notranslate nohighlight">\(\Sigma = aT + b\)</span>, with <span class="math notranslate nohighlight">\(T\)</span> in degrees C. Used only if <a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.std_dev.use_param"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.pdd</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.std_dev</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.use_param</span></code></a> is set to yes.</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.std_dev.param_b"><code class="docutils literal notranslate"><span class="pre">param_b</span></code></a> (0.66<em> Kelvin</em>) Parameter <span class="math notranslate nohighlight">\(b\)</span> in <span class="math notranslate nohighlight">\(\Sigma = aT + b\)</span>, with <span class="math notranslate nohighlight">\(T\)</span> in degrees C. Used only if <a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.std_dev.use_param"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.pdd</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.std_dev</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.use_param</span></code></a> is set to yes.</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.std_dev.periodic"><code class="docutils literal notranslate"><span class="pre">periodic</span></code></a> (no) If true, interpret <code class="docutils literal notranslate"><span class="pre">air_temp_sd</span></code> read from <a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.std_dev.file"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.pdd</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.std_dev</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.file</span></code></a> as periodic in time</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.std_dev.use_param"><code class="docutils literal notranslate"><span class="pre">use_param</span></code></a> (no) Parameterize standard deviation as a linear function of air temperature over ice-covered grid cells. The region of application is controlled by <a class="reference internal" href="../manual/parameters/index.html#config-geometry.ice_free_thickness_standard"><code class="docutils literal notranslate"><span class="pre">geometry</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.ice_free_thickness_standard</span></code></a>.</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.std_dev.value"><code class="docutils literal notranslate"><span class="pre">value</span></code></a> (5<em> Kelvin</em>) standard deviation of daily temp variation; = EISMINT-Greenland value <span id="id3">[<a class="reference internal" href="../zzz_references_html.html#id386" title="C. Ritz. EISMINT Intercomparison Experiment: Comparison of existing Greenland models. 1997. URL: https://web.archive.org/web/20220120054655/http://homepages.vub.ac.be/~phuybrec/eismint/greenland.html.">148</a>]</span></p></li>
</ol>
<p>A file <code class="docutils literal notranslate"><span class="pre">foo.nc</span></code> used with <code class="docutils literal notranslate"><span class="pre">-surface</span> <span class="pre">pdd</span> <span class="pre">-pdd_sd_file</span> <span class="pre">foo.nc</span></code> should contain standard
deviation of near-surface air temperature in variable <code class="variable docutils literal notranslate"><span class="pre">air_temp_sd</span></code>, and the
corresponding time coordinate in variable <code class="variable docutils literal notranslate"><span class="pre">time</span></code>. If <code class="docutils literal notranslate"><span class="pre">-pdd_sd_file</span></code> is not set,
PISM uses a constant value for standard deviation, which is set by the
configuration parameter <a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.std_dev.value"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.pdd</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.std_dev</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.value</span></code></a>. The default value is <span class="math notranslate nohighlight">\(5.0\)</span> degrees
<span id="id4">[<a class="reference internal" href="../zzz_references_html.html#id386" title="C. Ritz. EISMINT Intercomparison Experiment: Comparison of existing Greenland models. 1997. URL: https://web.archive.org/web/20220120054655/http://homepages.vub.ac.be/~phuybrec/eismint/greenland.html.">148</a>]</span>. However, this approach is not recommended as it induces significant
errors in modeled surface mass balance in both ice-covered and ice-free regions
<span id="id5">[<a class="reference internal" href="../zzz_references_html.html#id394" title="I. Rogozhina and D. Rau. Vital role of daily temperature variability in surface mass balance parameterizations of the greenland ice sheet. The Cryosphere, 8:575-585, 2014. doi:10.5194/tc-8-575-2014.">154</a>]</span>, <span id="id6">[<a class="reference internal" href="../zzz_references_html.html#id421" title="J. Seguinot. Spatial and seasonal effects of temperature variability in a positive degree day surface melt model. J. Glaciol., 59(218):1202-1204, 2013. doi:10.3189/2013JoG13J081.">155</a>]</span>.</p>
<p>Over ice-covered grid cells, daily variability can also be parameterized as a linear
function of near-surface air temperature <span class="math notranslate nohighlight">\(\sigma = a \cdot T + b\)</span> using the
<a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.std_dev.use_param"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.pdd</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.std_dev</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.use_param</span></code></a> configuration flag, and the corresponding
parameters <a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.std_dev.param_a"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.pdd</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.std_dev</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.param_a</span></code></a> and
<a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.std_dev.param_b"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.pdd</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.std_dev</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.param_b</span></code></a>. This parametrization replaces prescribed standard
deviation values over glacierized grid cells as defined by the <code class="variable docutils literal notranslate"><span class="pre">mask</span></code> variable (see
<a class="reference internal" href="../manual/parameters/index.html#config-geometry.ice_free_thickness_standard"><code class="docutils literal notranslate"><span class="pre">geometry</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.ice_free_thickness_standard</span></code></a>). Default values for the slope <span class="math notranslate nohighlight">\(a\)</span> and
intercept <span class="math notranslate nohighlight">\(b\)</span> were derived from the ERA-40 reanalysis over the Greenland ice sheet
<span id="id7">[<a class="reference internal" href="../zzz_references_html.html#id422" title="J. Seguinot and I. Rogozhina. Daily temperature variability predetermined by thermal conditions over ice sheet surfaces. J. Glaciol., 2014. doi:10.3189/2014JoG14J036.">156</a>]</span>.</p>
<p>The number of positive degree days is computed as the magnitude of the temperature
excursion above <span class="math notranslate nohighlight">\(0\!\phantom{|}^\circ \text{C}\)</span> multiplied by the duration (in days)
when it is above zero.</p>
<p>In PISM there are two methods for computing the number of positive degree days. The first
computes only the expected value, by the method described in <span id="id8">[<a class="reference internal" href="../zzz_references_html.html#id96" title="Reinhard Calov and Ralf Greve. Correspondence: A semi-analytical solution for the positive degree-day model with stochastic temperature variations. J. Glaciol, 51(172):173–175, 2005.">153</a>]</span>. This is
the default when a PDD is chosen (i.e. option <code class="option docutils literal notranslate"><span class="pre">-surface</span> <span class="pre">pdd</span></code>). The second is a Monte
Carlo simulation of the white noise itself, chosen by adding the option <code class="option docutils literal notranslate"><span class="pre">-pdd_method</span>
<span class="pre">random_process</span></code>. This Monte Carlo simulation adds the same daily variation at every point,
though the seasonal cycle is (generally) location dependent. If repeatable randomness is
desired use <code class="option docutils literal notranslate"><span class="pre">-pdd_method</span> <span class="pre">repeatable_random_process</span></code> instead.</p>
<figure class="align-default" id="fig-pdd-model">
<img alt="../_images/pdd-model-flowchart.png" src="../_images/pdd-model-flowchart.png" />
<figcaption>
<p><span class="caption-number">Fig. 47 </span><span class="caption-text">PISM’s positive degree day model. <span class="math notranslate nohighlight">\(F_s\)</span> and <span class="math notranslate nohighlight">\(F_i\)</span> are PDD factors for snow
and ice, respectively; <span class="math notranslate nohighlight">\(\theta_{\text{refreeze}}\)</span> is the refreeze fraction.</span><a class="headerlink" href="#fig-pdd-model" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>By default, the computation summarized in <a class="reference internal" href="#fig-pdd-model"><span class="std std-numref">Fig. 47</span></a> is performed every week.
(This frequency is controlled by the parameter <a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.max_evals_per_year"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.pdd</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.max_evals_per_year</span></code></a>.)
To compute mass balance during each week-long time-step, PISM keeps track of the current
snow depth (using units of ice-equivalent thickness). This is necessary to determine if
melt should be computed using the degree day factor for snow
(<a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.factor_snow"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.pdd</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.factor_snow</span></code></a>) or the corresponding factor for ice
(<a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.factor_ice"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.pdd</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.factor_ice</span></code></a>).</p>
<p>A fraction of the melt controlled by the configuration parameter <a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.refreeze"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.pdd</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.refreeze</span></code></a>
(<span class="math notranslate nohighlight">\(\theta_{\text{refreeze}}\)</span> in <a class="reference internal" href="#fig-pdd-model"><span class="std std-numref">Fig. 47</span></a>, default: <span class="math notranslate nohighlight">\(0.6\)</span>)
refreezes. The user can select whether melted ice should be allowed to refreeze using the
configuration flag <a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.refreeze_ice_melt"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.pdd</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.refreeze_ice_melt</span></code></a>.</p>
<p>Since PISM does not have a principled firn model, the snow depth is set to zero at the
beginning of the balance year. See <a class="reference internal" href="../manual/parameters/index.html#config-surface.mass_balance_year_start_day"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.mass_balance_year_start_day</span></code></a>. Default is
<span class="math notranslate nohighlight">\(274\)</span>, corresponding to October 1<sup>st</sup>.</p>
<p>Our PDD implementation is meant to be used with an atmosphere model implementing a cosine
yearly cycle such as <code class="docutils literal notranslate"><span class="pre">searise_greenland</span></code> (section
<a class="reference internal" href="atmosphere.html#sec-atmosphere-searise-greenland"><span class="std std-ref">SeaRISE-Greenland</span></a>), but it is not restricted to parameterizations
like these.</p>
<p>This code also implements latitude- and mean July temperature dependent ice and snow
factors using formulas (6) and (7) in <span id="id9">[<a class="reference internal" href="../zzz_references_html.html#id134" title="R. S. Fausto, A. P. Ahlstrom, D. Van As, C. E. Boggild, and S. J. Johnsen. A new present-day temperature parameterization for Greenland. J. Glaciol., 55(189):95–105, 2009.">145</a>]</span>; set <code class="option docutils literal notranslate"><span class="pre">-pdd_fausto</span></code> to enable.
The default standard deviation of the daily variability (option <code class="option docutils literal notranslate"><span class="pre">-pdd_std_dev</span></code>) is
2.53 degrees when <code class="option docutils literal notranslate"><span class="pre">-pdd_fausto</span></code> is set <span id="id10">[<a class="reference internal" href="../zzz_references_html.html#id134" title="R. S. Fausto, A. P. Ahlstrom, D. Van As, C. E. Boggild, and S. J. Johnsen. A new present-day temperature parameterization for Greenland. J. Glaciol., 55(189):95–105, 2009.">145</a>]</span>. See also configuration
parameters with the prefix <code class="docutils literal notranslate"><span class="pre">surface.pdd.fausto.</span></code>:</p>
<ol class="simple">
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.fausto.T_c"><code class="docutils literal notranslate"><span class="pre">T_c</span></code></a> (272.15<em> Kelvin</em>) = -1 + 273.15; for formula (6) in <span id="id11">[<a class="reference internal" href="../zzz_references_html.html#id134" title="R. S. Fausto, A. P. Ahlstrom, D. Van As, C. E. Boggild, and S. J. Johnsen. A new present-day temperature parameterization for Greenland. J. Glaciol., 55(189):95–105, 2009.">145</a>]</span></p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.fausto.T_w"><code class="docutils literal notranslate"><span class="pre">T_w</span></code></a> (283.15<em> Kelvin</em>) = 10 + 273.15; for formula (6) in <span id="id12">[<a class="reference internal" href="../zzz_references_html.html#id134" title="R. S. Fausto, A. P. Ahlstrom, D. Van As, C. E. Boggild, and S. J. Johnsen. A new present-day temperature parameterization for Greenland. J. Glaciol., 55(189):95–105, 2009.">145</a>]</span></p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.fausto.beta_ice_c"><code class="docutils literal notranslate"><span class="pre">beta_ice_c</span></code></a> (0.015<em> meter / (Kelvin day)</em>) water-equivalent thickness; for formula (6) in <span id="id13">[<a class="reference internal" href="../zzz_references_html.html#id134" title="R. S. Fausto, A. P. Ahlstrom, D. Van As, C. E. Boggild, and S. J. Johnsen. A new present-day temperature parameterization for Greenland. J. Glaciol., 55(189):95–105, 2009.">145</a>]</span></p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.fausto.beta_ice_w"><code class="docutils literal notranslate"><span class="pre">beta_ice_w</span></code></a> (0.007<em> meter / (Kelvin day)</em>) water-equivalent thickness; for formula (6) in <span id="id14">[<a class="reference internal" href="../zzz_references_html.html#id134" title="R. S. Fausto, A. P. Ahlstrom, D. Van As, C. E. Boggild, and S. J. Johnsen. A new present-day temperature parameterization for Greenland. J. Glaciol., 55(189):95–105, 2009.">145</a>]</span></p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.fausto.beta_snow_c"><code class="docutils literal notranslate"><span class="pre">beta_snow_c</span></code></a> (0.003<em> meter / (Kelvin day)</em>) water-equivalent thickness; for formula (6) in <span id="id15">[<a class="reference internal" href="../zzz_references_html.html#id134" title="R. S. Fausto, A. P. Ahlstrom, D. Van As, C. E. Boggild, and S. J. Johnsen. A new present-day temperature parameterization for Greenland. J. Glaciol., 55(189):95–105, 2009.">145</a>]</span></p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.fausto.beta_snow_w"><code class="docutils literal notranslate"><span class="pre">beta_snow_w</span></code></a> (0.003<em> meter / (Kelvin day)</em>) water-equivalent thickness; for formula (6) in <span id="id16">[<a class="reference internal" href="../zzz_references_html.html#id134" title="R. S. Fausto, A. P. Ahlstrom, D. Van As, C. E. Boggild, and S. J. Johnsen. A new present-day temperature parameterization for Greenland. J. Glaciol., 55(189):95–105, 2009.">145</a>]</span></p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.fausto.enabled"><code class="docutils literal notranslate"><span class="pre">enabled</span></code></a> (false) Set PDD parameters using formulas (6) and (7) in <span id="id17">[<a class="reference internal" href="../zzz_references_html.html#id134" title="R. S. Fausto, A. P. Ahlstrom, D. Van As, C. E. Boggild, and S. J. Johnsen. A new present-day temperature parameterization for Greenland. J. Glaciol., 55(189):95–105, 2009.">145</a>]</span></p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.fausto.latitude_beta_w"><code class="docutils literal notranslate"><span class="pre">latitude_beta_w</span></code></a> (72<em> degree_north</em>) latitude below which to use warm case, in formula (6) in <span id="id18">[<a class="reference internal" href="../zzz_references_html.html#id134" title="R. S. Fausto, A. P. Ahlstrom, D. Van As, C. E. Boggild, and S. J. Johnsen. A new present-day temperature parameterization for Greenland. J. Glaciol., 55(189):95–105, 2009.">145</a>]</span></p></li>
</ol>
<p>Note that when used with periodic climate data (air temperature and precipitation) that is
read from a file (see section <a class="reference internal" href="atmosphere.html#sec-atmosphere-given"><span class="std std-ref">Boundary conditions read from a file</span></a>), use of
<a class="reference internal" href="../manual/parameters/index.html#config-time_stepping.hit_multiples"><code class="docutils literal notranslate"><span class="pre">time_stepping</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.hit_multiples</span></code></a> is recommended: set it to the length of the climate
data period in years.</p>
<p>This model provides the following scalar:</p>
<ul class="simple">
<li><p><code class="variable docutils literal notranslate"><span class="pre">surface_accumulation_rate</span></code></p></li>
<li><p><code class="variable docutils literal notranslate"><span class="pre">surface_melt_rate</span></code></p></li>
<li><p><code class="variable docutils literal notranslate"><span class="pre">surface_runoff_rate</span></code></p></li>
</ul>
<p>and these 2D diagnostic quantities (averaged over reporting intervals; positive flux
corresponds to ice gain):</p>
<ul class="simple">
<li><p><code class="variable docutils literal notranslate"><span class="pre">surface_accumulation_flux</span></code></p></li>
<li><p><code class="variable docutils literal notranslate"><span class="pre">surface_melt_flux</span></code></p></li>
<li><p><code class="variable docutils literal notranslate"><span class="pre">surface_runoff_flux</span></code></p></li>
</ul>
<p>This makes it easy to compare the surface mass balance computed by the model to its
individual components:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SMB</span> <span class="o">=</span> <span class="n">surface_accumulation_flux</span> <span class="o">-</span> <span class="n">surface_runoff_flux</span>
</pre></div>
</div>
<p class="rubric">Parameters</p>
<p>Prefix: <code class="docutils literal notranslate"><span class="pre">surface.pdd.</span></code></p>
<ol class="simple">
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.air_temp_all_precip_as_rain"><code class="docutils literal notranslate"><span class="pre">air_temp_all_precip_as_rain</span></code></a> (275.15<em> Kelvin</em>) threshold temperature above which all precipitation is rain; must exceed <a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.air_temp_all_precip_as_snow"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.pdd</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.air_temp_all_precip_as_snow</span></code></a> to avoid division by zero, because difference is in a denominator</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.air_temp_all_precip_as_snow"><code class="docutils literal notranslate"><span class="pre">air_temp_all_precip_as_snow</span></code></a> (273.15<em> Kelvin</em>) threshold temperature below which all precipitation is snow</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.factor_ice"><code class="docutils literal notranslate"><span class="pre">factor_ice</span></code></a> (0.00879121<em> meter / (Kelvin day)</em>) EISMINT-Greenland value <span id="id19">[<a class="reference internal" href="../zzz_references_html.html#id386" title="C. Ritz. EISMINT Intercomparison Experiment: Comparison of existing Greenland models. 1997. URL: https://web.archive.org/web/20220120054655/http://homepages.vub.ac.be/~phuybrec/eismint/greenland.html.">148</a>]</span>; = (8 mm liquid-water-equivalent) / (pos degree day)</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.factor_snow"><code class="docutils literal notranslate"><span class="pre">factor_snow</span></code></a> (0.0032967<em> meter / (Kelvin day)</em>) EISMINT-Greenland value <span id="id20">[<a class="reference internal" href="../zzz_references_html.html#id386" title="C. Ritz. EISMINT Intercomparison Experiment: Comparison of existing Greenland models. 1997. URL: https://web.archive.org/web/20220120054655/http://homepages.vub.ac.be/~phuybrec/eismint/greenland.html.">148</a>]</span>; = (3 mm liquid-water-equivalent) / (pos degree day)</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.fausto.T_c"><code class="docutils literal notranslate"><span class="pre">fausto</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.T_c</span></code></a> (272.15<em> Kelvin</em>) = -1 + 273.15; for formula (6) in <span id="id21">[<a class="reference internal" href="../zzz_references_html.html#id134" title="R. S. Fausto, A. P. Ahlstrom, D. Van As, C. E. Boggild, and S. J. Johnsen. A new present-day temperature parameterization for Greenland. J. Glaciol., 55(189):95–105, 2009.">145</a>]</span></p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.fausto.T_w"><code class="docutils literal notranslate"><span class="pre">fausto</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.T_w</span></code></a> (283.15<em> Kelvin</em>) = 10 + 273.15; for formula (6) in <span id="id22">[<a class="reference internal" href="../zzz_references_html.html#id134" title="R. S. Fausto, A. P. Ahlstrom, D. Van As, C. E. Boggild, and S. J. Johnsen. A new present-day temperature parameterization for Greenland. J. Glaciol., 55(189):95–105, 2009.">145</a>]</span></p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.fausto.beta_ice_c"><code class="docutils literal notranslate"><span class="pre">fausto</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.beta_ice_c</span></code></a> (0.015<em> meter / (Kelvin day)</em>) water-equivalent thickness; for formula (6) in <span id="id23">[<a class="reference internal" href="../zzz_references_html.html#id134" title="R. S. Fausto, A. P. Ahlstrom, D. Van As, C. E. Boggild, and S. J. Johnsen. A new present-day temperature parameterization for Greenland. J. Glaciol., 55(189):95–105, 2009.">145</a>]</span></p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.fausto.beta_ice_w"><code class="docutils literal notranslate"><span class="pre">fausto</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.beta_ice_w</span></code></a> (0.007<em> meter / (Kelvin day)</em>) water-equivalent thickness; for formula (6) in <span id="id24">[<a class="reference internal" href="../zzz_references_html.html#id134" title="R. S. Fausto, A. P. Ahlstrom, D. Van As, C. E. Boggild, and S. J. Johnsen. A new present-day temperature parameterization for Greenland. J. Glaciol., 55(189):95–105, 2009.">145</a>]</span></p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.fausto.beta_snow_c"><code class="docutils literal notranslate"><span class="pre">fausto</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.beta_snow_c</span></code></a> (0.003<em> meter / (Kelvin day)</em>) water-equivalent thickness; for formula (6) in <span id="id25">[<a class="reference internal" href="../zzz_references_html.html#id134" title="R. S. Fausto, A. P. Ahlstrom, D. Van As, C. E. Boggild, and S. J. Johnsen. A new present-day temperature parameterization for Greenland. J. Glaciol., 55(189):95–105, 2009.">145</a>]</span></p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.fausto.beta_snow_w"><code class="docutils literal notranslate"><span class="pre">fausto</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.beta_snow_w</span></code></a> (0.003<em> meter / (Kelvin day)</em>) water-equivalent thickness; for formula (6) in <span id="id26">[<a class="reference internal" href="../zzz_references_html.html#id134" title="R. S. Fausto, A. P. Ahlstrom, D. Van As, C. E. Boggild, and S. J. Johnsen. A new present-day temperature parameterization for Greenland. J. Glaciol., 55(189):95–105, 2009.">145</a>]</span></p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.fausto.enabled"><code class="docutils literal notranslate"><span class="pre">fausto</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.enabled</span></code></a> (false) Set PDD parameters using formulas (6) and (7) in <span id="id27">[<a class="reference internal" href="../zzz_references_html.html#id134" title="R. S. Fausto, A. P. Ahlstrom, D. Van As, C. E. Boggild, and S. J. Johnsen. A new present-day temperature parameterization for Greenland. J. Glaciol., 55(189):95–105, 2009.">145</a>]</span></p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.fausto.latitude_beta_w"><code class="docutils literal notranslate"><span class="pre">fausto</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.latitude_beta_w</span></code></a> (72<em> degree_north</em>) latitude below which to use warm case, in formula (6) in <span id="id28">[<a class="reference internal" href="../zzz_references_html.html#id134" title="R. S. Fausto, A. P. Ahlstrom, D. Van As, C. E. Boggild, and S. J. Johnsen. A new present-day temperature parameterization for Greenland. J. Glaciol., 55(189):95–105, 2009.">145</a>]</span></p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.firn_compaction_to_accumulation_ratio"><code class="docutils literal notranslate"><span class="pre">firn_compaction_to_accumulation_ratio</span></code></a> (0.75) How much firn as a fraction of accumulation is turned into ice</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.firn_depth_file"><code class="docutils literal notranslate"><span class="pre">firn_depth_file</span></code></a> The name of the file to read the firn_depth from.</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.interpret_precip_as_snow"><code class="docutils literal notranslate"><span class="pre">interpret_precip_as_snow</span></code></a> (no) Interpret precipitation as snow fall.</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.max_evals_per_year"><code class="docutils literal notranslate"><span class="pre">max_evals_per_year</span></code></a> (52) maximum number of times the PDD scheme will ask for air temperature and precipitation to build location-dependent time series for computing (expected) number of positive degree days and snow accumulation; the default means the PDD uses weekly samples of the annual cycle; see also <a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.std_dev.value"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.pdd</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.std_dev</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.value</span></code></a></p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.method"><code class="docutils literal notranslate"><span class="pre">method</span></code></a> (<code class="docutils literal notranslate"><span class="pre">expectation_integral</span></code>) PDD implementation method</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.positive_threshold_temp"><code class="docutils literal notranslate"><span class="pre">positive_threshold_temp</span></code></a> (273.15<em> Kelvin</em>) temperature used to determine meaning of “positive” degree day</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.refreeze"><code class="docutils literal notranslate"><span class="pre">refreeze</span></code></a> (0.6) EISMINT-Greenland value <span id="id29">[<a class="reference internal" href="../zzz_references_html.html#id386" title="C. Ritz. EISMINT Intercomparison Experiment: Comparison of existing Greenland models. 1997. URL: https://web.archive.org/web/20220120054655/http://homepages.vub.ac.be/~phuybrec/eismint/greenland.html.">148</a>]</span></p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.refreeze_ice_melt"><code class="docutils literal notranslate"><span class="pre">refreeze_ice_melt</span></code></a> (yes) If set to “yes”, refreeze <a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.refreeze"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.pdd</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.refreeze</span></code></a> fraction of melted ice, otherwise all of the melted ice runs off.</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.std_dev.file"><code class="docutils literal notranslate"><span class="pre">std_dev</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.file</span></code></a> The name of the file to read <code class="docutils literal notranslate"><span class="pre">air_temp_sd</span></code> (standard deviation of air temperature) from.</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.std_dev.lapse_lat_base"><code class="docutils literal notranslate"><span class="pre">std_dev</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.lapse_lat_base</span></code></a> (72<em> degree_north</em>) standard deviationis is a function of latitude, with value <a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.std_dev.value"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.pdd</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.std_dev</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.value</span></code></a> at this latitude; this value is only active if <a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.std_dev.lapse_lat_rate"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.pdd</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.std_dev</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.lapse_lat_rate</span></code></a> is nonzero</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.std_dev.lapse_lat_rate"><code class="docutils literal notranslate"><span class="pre">std_dev</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.lapse_lat_rate</span></code></a> (0<em> Kelvin / degree_north</em>) standard deviation is a function of latitude, with rate of change with respect to latitude given by this constant</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.std_dev.param_a"><code class="docutils literal notranslate"><span class="pre">std_dev</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.param_a</span></code></a> (-0.15) Parameter <span class="math notranslate nohighlight">\(a\)</span> in <span class="math notranslate nohighlight">\(\Sigma = aT + b\)</span>, with <span class="math notranslate nohighlight">\(T\)</span> in degrees C. Used only if <a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.std_dev.use_param"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.pdd</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.std_dev</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.use_param</span></code></a> is set to yes.</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.std_dev.param_b"><code class="docutils literal notranslate"><span class="pre">std_dev</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.param_b</span></code></a> (0.66<em> Kelvin</em>) Parameter <span class="math notranslate nohighlight">\(b\)</span> in <span class="math notranslate nohighlight">\(\Sigma = aT + b\)</span>, with <span class="math notranslate nohighlight">\(T\)</span> in degrees C. Used only if <a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.std_dev.use_param"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.pdd</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.std_dev</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.use_param</span></code></a> is set to yes.</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.std_dev.periodic"><code class="docutils literal notranslate"><span class="pre">std_dev</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.periodic</span></code></a> (no) If true, interpret <code class="docutils literal notranslate"><span class="pre">air_temp_sd</span></code> read from <a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.std_dev.file"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.pdd</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.std_dev</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.file</span></code></a> as periodic in time</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.std_dev.use_param"><code class="docutils literal notranslate"><span class="pre">std_dev</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.use_param</span></code></a> (no) Parameterize standard deviation as a linear function of air temperature over ice-covered grid cells. The region of application is controlled by <a class="reference internal" href="../manual/parameters/index.html#config-geometry.ice_free_thickness_standard"><code class="docutils literal notranslate"><span class="pre">geometry</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.ice_free_thickness_standard</span></code></a>.</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.pdd.std_dev.value"><code class="docutils literal notranslate"><span class="pre">std_dev</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.value</span></code></a> (5<em> Kelvin</em>) standard deviation of daily temp variation; = EISMINT-Greenland value <span id="id30">[<a class="reference internal" href="../zzz_references_html.html#id386" title="C. Ritz. EISMINT Intercomparison Experiment: Comparison of existing Greenland models. 1997. URL: https://web.archive.org/web/20220120054655/http://homepages.vub.ac.be/~phuybrec/eismint/greenland.html.">148</a>]</span></p></li>
</ol>
</section>
<section id="diurnal-energy-balance-model-debm-simple">
<span id="sec-surface-debm-simple"></span><h2><a class="toc-backref" href="#id50">Diurnal Energy Balance Model “dEBM-simple”</a><a class="headerlink" href="#diurnal-energy-balance-model-debm-simple" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">-surface</span> <span class="pre">debm_simple</span></code></p>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><p><code class="variable docutils literal notranslate"><span class="pre">surface_albedo</span></code></p>
</dd>
<dt class="field-odd">C++ class</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">pism::surface::DEBMSimple</span></code></p>
</dd>
</dl>
<p>This PISM module implements the “simple” version of the diurnal energy balance model
developed by <span id="id31">[<a class="reference internal" href="../zzz_references_html.html#id12" title="M. Zeitz, R. Reese, J. Beckmann, U. Krebs-Kanzow, and R. Winkelmann. Impact of the melt-albedo feedback on the future evolution of the Greenland ice sheet with PISM-dEBM-simple. The Cryosphere, 15(12):5739–5764, 2021. URL: https://tc.copernicus.org/articles/15/5739/2021/, doi:10.5194/tc-15-5739-2021.">157</a>]</span>. It follows <span id="id32">[<a class="reference internal" href="../zzz_references_html.html#id11" title="Uta Krebs-Kanzow, Paul Gierz, and Gerrit Lohmann. Brief communication: An ice surface melt scheme including the diurnal cycle of solar radiation. The Cryosphere, 12(12):3923–3930, dec 2018. doi:10.5194/tc-12-3923-2018.">158</a>]</span> and includes
parameterizations of the surface albedo and the atmospheric transmissivity that make it
possible to run the model in a standalone, prognostic mode.</p>
<p>It is designed to use time-dependent forcing by near-surface air temperature and total
(i.e. liquid <em>and</em> solid) precipitation provided by one of PISM’s atmosphere models. The
temperature forcing should resolve the annual cycle, i.e. it should use <em>monthly or more
frequent</em> temperature records if forced using <a class="reference internal" href="atmosphere.html#sec-atmosphere-given"><span class="std std-ref">Boundary conditions read from a file</span></a>. In cases when
only annual temperature records are available we recommend using the
<a class="reference internal" href="atmosphere.html#sec-atmosphere-yearly-cycle"><span class="std std-ref">Cosine yearly cycle</span></a> approximation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We recommend setting <a class="reference internal" href="../manual/parameters/index.html#config-time_stepping.hit_multiples"><code class="docutils literal notranslate"><span class="pre">time_stepping</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.hit_multiples</span></code></a> to the length of the climate
data period in years when forcing dEBM-simple with periodic climate data that are read
from a file.</p>
</div>
<p>Similarly to other surface models, the outputs are</p>
<ul class="simple">
<li><p>ice temperature at its top surface</p></li>
<li><p>climatic mass balance (SMB)</p></li>
</ul>
<p>dEBM-simple re-interprets near-surface air temperature to produce the ice temperature at
its top surface.</p>
<p>SMB is defined as</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\text{SMB} &amp;= \text{Solid accumulation} - \text{Runoff},\\\text{SMB} &amp;= \text{Solid accumulation} - \left(\text{Melt} - \text{Refreeze} \right).\end{aligned}\end{align} \]</div>
<p>Solid accumulation is approximated using provided total precipitation and a linear
transition from interpreting it as “all snow” when the air temperature is below
<a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.air_temp_all_precip_as_snow"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.debm_simple</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.air_temp_all_precip_as_snow</span></code></a> (default of <span class="math notranslate nohighlight">\(0^\circ C\)</span>) to “all
rain” when the air temperature is above
<a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.air_temp_all_precip_as_rain"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.debm_simple</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.air_temp_all_precip_as_rain</span></code></a> (default of <span class="math notranslate nohighlight">\(2^\circ C\)</span>).
Alternatively, all precipitation is interpreted as snow if
<a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.interpret_precip_as_snow"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.debm_simple</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.interpret_precip_as_snow</span></code></a> is set.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Part of the precipitation that is interpreted as rain is assumed to run off
instantaneously and <em>does not</em> contribute to reported modeled runoff.</p>
</div>
<p>A fraction <span class="math notranslate nohighlight">\(\theta\)</span> (<a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.refreeze"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.debm_simple</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.refreeze</span></code></a>) of computed melt amount is
assumed to re-freeze:</p>
<div class="math notranslate nohighlight" id="equation-eq-debm-refreeze">
<span class="eqno">(44)<a class="headerlink" href="#equation-eq-debm-refreeze" title="Permalink to this equation">¶</a></span>\[\text{Refreeze} = \theta\, \text{Melt}.\]</div>
<p>By default only snow melt is allowed to refreeze; set
<a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.refreeze_ice_melt"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.debm_simple</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.refreeze_ice_melt</span></code></a> to refreeze both snow and ice melt. To
distinguish between melted snow and ice dEBM-simple keeps track of the evolving snow depth
during a balance year and resets it to zero once a year on the day set using
<a class="reference internal" href="../manual/parameters/index.html#config-surface.mass_balance_year_start_day"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.mass_balance_year_start_day</span></code></a>.</p>
<p>Let <span class="math notranslate nohighlight">\(T\)</span> be the near-surface air temperature and define</p>
<div class="math notranslate nohighlight" id="equation-eq-debm-melt-components">
<span class="eqno">(45)<a class="headerlink" href="#equation-eq-debm-melt-components" title="Permalink to this equation">¶</a></span>\[ \begin{align}\begin{aligned}M_I &amp;= \frac{\Delta t_{\Phi}}{\Delta t \rho_{\text{w}} L_{\text{m}}} \tau_\text{A}
( 1 - \alpha ) \bar S_{\Phi},\\M_T &amp;= \frac{\Delta t_{\Phi}}{\Delta t \rho_{\text{w}} L_{\text{m}}}
c_1 T_\text{eff},\\M_O &amp;= \frac{\Delta t_{\Phi}}{\Delta t \rho_{\text{w}} L_{\text{m}}}
c_2,\end{aligned}\end{align} \]</div>
<p>then the average daily melt rate is approximated by</p>
<div class="math notranslate nohighlight" id="equation-eq-debm-melt">
<span class="eqno">(46)<a class="headerlink" href="#equation-eq-debm-melt" title="Permalink to this equation">¶</a></span>\[\begin{split}M &amp;=
\begin{cases}
M_I + M_T + M_O,&amp;
T \ge T_{\text{min}},\\
0,&amp; T &lt; T_{\text{min}}.
\end{cases},\end{split}\]</div>
<p>Here</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(M_I\)</span> is the <em>insolation-driven melt contribution</em> representing the net uptake of
incoming solar shortwave radiation of the surface during the diurnal melt period,</p></li>
<li><p><span class="math notranslate nohighlight">\(M_T\)</span> is the <em>temperature-driven melt contribution</em> representing the
air-temperature-dependent part of the incoming longwave radiation as well as turbulent
sensible heat fluxes,</p></li>
<li><p><span class="math notranslate nohighlight">\(M_O\)</span> is the negative <em>melt offset</em> representing the outgoing longwave radiation and the
air temperature-independent part of the incoming longwave radiation <span id="id33">[<a class="reference internal" href="../zzz_references_html.html#id2" title="Julius Garbe, Maria Zeitz, Uta Krebs-Kanzow, and Ricarda Winkelmann. The evolution of future Antarctic surface melt using PISM-dEBM-simple. The Cryosphere, 17(11):4571–4599, nov 2023. doi:10.5194/tc-17-4571-2023.">159</a>]</span>.</p></li>
</ul>
<p>See <a class="reference internal" href="#tab-debm-simple-notation"><span class="std std-numref">Table 36</span></a> for details and note that <a class="reference internal" href="#equation-eq-debm-melt">(46)</a> is
equation 1 in <span id="id34">[<a class="reference internal" href="../zzz_references_html.html#id12" title="M. Zeitz, R. Reese, J. Beckmann, U. Krebs-Kanzow, and R. Winkelmann. Impact of the melt-albedo feedback on the future evolution of the Greenland ice sheet with PISM-dEBM-simple. The Cryosphere, 15(12):5739–5764, 2021. URL: https://tc.copernicus.org/articles/15/5739/2021/, doi:10.5194/tc-15-5739-2021.">157</a>]</span>.</p>
<p>The following two sections describe implementations of insolation-driven and
temperature-driven melt contributions.</p>
<table class="colwidths-given docutils align-default" id="tab-debm-simple-notation">
<caption><span class="caption-number">Table 36 </span><span class="caption-text">Notation used in <a class="reference internal" href="#equation-eq-debm-melt-components">(45)</a> and <a class="reference internal" href="#equation-eq-debm-melt">(46)</a></span><a class="headerlink" href="#tab-debm-simple-notation" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 67%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Quantity</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\Phi\)</span></p></td>
<td><p>Threshold for the solar elevation angle (<a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.phi"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.debm_simple</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.phi</span></code></a>). It is
assumed that melt can occur only when the sun is above this angle. <span class="math notranslate nohighlight">\(\Phi\)</span> should be
treated as a tuning parameter since its value is not well constrained.</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\Delta t_{\Phi} / \Delta t\)</span></p></td>
<td><p>Fraction of the day during which the sun is above the elevation angle <span class="math notranslate nohighlight">\(\Phi\)</span> and
melt can occur</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\tau_A\)</span></p></td>
<td><p>Transmissivity of the atmosphere</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\alpha\)</span></p></td>
<td><p>Surface albedo</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\bar S_{\Phi}\)</span></p></td>
<td><p>Mean top of the atmosphere insolation during the part of the day when the sun
is above the elevation angle <span class="math notranslate nohighlight">\(\Phi\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(T_{\text{eff}}\)</span></p></td>
<td><p>“Effective air temperature” computed using provided air temperature forcing and
additional stochastic variations used to model the effect of daily temperature
variations (see <a class="reference internal" href="#equation-eq-debm-t-eff">(52)</a>, <span id="id35">[<a class="reference internal" href="../zzz_references_html.html#id12" title="M. Zeitz, R. Reese, J. Beckmann, U. Krebs-Kanzow, and R. Winkelmann. Impact of the melt-albedo feedback on the future evolution of the Greenland ice sheet with PISM-dEBM-simple. The Cryosphere, 15(12):5739–5764, 2021. URL: https://tc.copernicus.org/articles/15/5739/2021/, doi:10.5194/tc-15-5739-2021.">157</a>]</span> and
<span id="id36">[<a class="reference internal" href="../zzz_references_html.html#id96" title="Reinhard Calov and Ralf Greve. Correspondence: A semi-analytical solution for the positive degree-day model with stochastic temperature variations. J. Glaciol, 51(172):173–175, 2005.">153</a>]</span>)</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(c_1\)</span></p></td>
<td><p>Tuning parameter that controls the temperature influence on melt
(<a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.c1"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.debm_simple</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.c1</span></code></a>)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(c_2\)</span></p></td>
<td><p>Tuning parameter that controls the (negative) melt offset
(<a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.c2"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.debm_simple</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.c2</span></code></a>)</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\rho_w\)</span></p></td>
<td><p>Fresh water density (<a class="reference internal" href="../manual/parameters/index.html#config-constants.fresh_water.density"><code class="docutils literal notranslate"><span class="pre">constants</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.fresh_water</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.density</span></code></a>)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(L_m\)</span></p></td>
<td><p>Latent heat of fusion (<a class="reference internal" href="../manual/parameters/index.html#config-constants.fresh_water.latent_heat_of_fusion"><code class="docutils literal notranslate"><span class="pre">constants</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.fresh_water</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.latent_heat_of_fusion</span></code></a>)</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(T_{\text{min}}\)</span></p></td>
<td><p>Threshold temperature (<a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.melting_threshold_temp"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.debm_simple</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.melting_threshold_temp</span></code></a>). Melt
is prohibited if the air temperature is below <span class="math notranslate nohighlight">\(T_{\text{min}}\)</span> to avoid melt rates
from high insolation values and low albedo values when it is too cold to actually
melt.</p></td>
</tr>
</tbody>
</table>
<section id="insolation-driven-melt-contribution">
<span id="sec-debm-insolation-driven-melt"></span><h3><a class="toc-backref" href="#id51">Insolation-driven melt contribution</a><a class="headerlink" href="#insolation-driven-melt-contribution" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight" id="equation-eq-debm-insolation-melt">
<span class="eqno">(47)<a class="headerlink" href="#equation-eq-debm-insolation-melt" title="Permalink to this equation">¶</a></span>\[M_I = \frac{\Delta t_{\Phi}}{\Delta t \rho_{\text{w}} L_{\text{m}}} \left(
\tau_\text{A} \left( 1 - \alpha \right) \bar S_{\Phi} \right),\]</div>
<p>This term models the influence of the <em>mean insolation during the melt period</em> <span class="math notranslate nohighlight">\(\bar
S_{\Phi}\)</span>, the atmosphere transmissivity <span class="math notranslate nohighlight">\(\tau_{A}\)</span> and the surface albedo <span class="math notranslate nohighlight">\(\alpha\)</span>.</p>
<section id="mean-top-of-the-atmosphere-insolation">
<span id="sec-debm-simple-insolation"></span><h4><a class="toc-backref" href="#id52">Mean top of the atmosphere insolation</a><a class="headerlink" href="#mean-top-of-the-atmosphere-insolation" title="Permalink to this headline">¶</a></h4>
<p>The mean top of the atmosphere insolation during the part of the day when the sun is above
<span class="math notranslate nohighlight">\(\Phi\)</span> degrees is approximated by</p>
<div class="math notranslate nohighlight" id="equation-eq-debm-toa-insolation">
<span class="eqno">(48)<a class="headerlink" href="#equation-eq-debm-toa-insolation" title="Permalink to this equation">¶</a></span>\[\bar S_{\Phi} = \frac{S_0}{h_{\Phi}}  \left( \frac{\bar d}{d} \right)^2
\left( h_{\Phi}  \sin(\phi)  \sin(\delta) + \cos(\phi)  \cos(\delta)  \sin(h_{\Phi}) \right)\]</div>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(S_0\)</span> is the solar constant <a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.solar_constant"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.debm_simple</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.solar_constant</span></code></a> <span id="id37">[<a class="reference internal" href="../zzz_references_html.html#id3" title="Greg Kopp and Judith L. Lean. A new, lower value of total solar irradiance: Evidence and climate significance. Geophysical Research Letters, jan 2011. doi:10.1029/2010gl045777.">152</a>]</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(\bar d / d\)</span> is the ratio of the length of the semimajor axis of the Earth’s orbit to
the Earth-Sun distance,</p></li>
<li><p><span class="math notranslate nohighlight">\(h_{\Phi}\)</span> is the hour angle when the sun has an elevation angle of at least <span class="math notranslate nohighlight">\(\Phi\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(\phi\)</span> is the latitude</p></li>
<li><p><span class="math notranslate nohighlight">\(\delta\)</span> is the solar declination angle.</p></li>
</ul>
<p>In short, <span class="math notranslate nohighlight">\(\bar S_{\Phi}\)</span> is a function of latitude, the factor <span class="math notranslate nohighlight">\(\bar d / d\)</span>, and the
solar declination angle <span class="math notranslate nohighlight">\(\delta\)</span>. In the “present day” case both <span class="math notranslate nohighlight">\(\bar d / d\)</span> and <span class="math notranslate nohighlight">\(\delta\)</span>
have the period of one year and are approximated using trigonometric expansions (see
<span id="id38">[<a class="reference internal" href="../zzz_references_html.html#id10" title="K. N. Liou. Introduction to Atmospheric Radiation. Elsevier Science &amp; Technology Books, 2002. ISBN 9780080491677.">160</a>]</span>).</p>
<p class="rubric">Paleo simulations</p>
<p>Trigonometric expansions for <span class="math notranslate nohighlight">\(\bar d / d\)</span> and <span class="math notranslate nohighlight">\(\delta\)</span> mentioned above are not applicable
when modeling times far from present; in this case we use more general (and more
computationally expensive) formulas (<span id="id39">[<a class="reference internal" href="../zzz_references_html.html#id10" title="K. N. Liou. Introduction to Atmospheric Radiation. Elsevier Science &amp; Technology Books, 2002. ISBN 9780080491677.">160</a>]</span>, chapter 2). Set
<a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.paleo.enabled"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.debm_simple</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.paleo</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.enabled</span></code></a> to switch to using the “paleo” mode.</p>
<p>In this case</p>
<ul class="simple">
<li><p>the ratio <span class="math notranslate nohighlight">\(\bar d / d\)</span> is a function of the eccentricity of the Earth’s orbit and the
perihelion longitude,</p></li>
<li><p>the solar declination <span class="math notranslate nohighlight">\(\delta\)</span> is a function of the eccentricity of the Earth’s orbit,
the perihelion longitude, and the Earth’s obliquity.</p></li>
</ul>
<p>The values of these are set using the following configuration parameters (prefix:
<code class="docutils literal notranslate"><span class="pre">surface.debm_simple.paleo.</span></code>):</p>
<ol class="simple">
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.paleo.eccentricity"><code class="docutils literal notranslate"><span class="pre">eccentricity</span></code></a> (0.0167) Eccentricity of the Earth’s orbit</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.paleo.obliquity"><code class="docutils literal notranslate"><span class="pre">obliquity</span></code></a> (23.44<em> degree</em>) Mean obliquity (axial tilt) of the Earth</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.paleo.perihelion_longitude"><code class="docutils literal notranslate"><span class="pre">perihelion_longitude</span></code></a> (102.947<em> degree</em>) Mean longitude of the perihelion relative to the vernal equinox</p></li>
</ol>
<p>Alternatively, PISM can read in scalar time series of variables <code class="variable docutils literal notranslate"><span class="pre">eccentricity</span></code>,
<code class="variable docutils literal notranslate"><span class="pre">obliquity</span></code>, and <code class="variable docutils literal notranslate"><span class="pre">perihelion_longitude</span></code> from a file specified using
<a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.paleo.file"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.debm_simple</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.paleo</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.file</span></code></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We provide a script (<code class="docutils literal notranslate"><span class="pre">examples/debm_simple/orbital_parameters.py</span></code>) that can be used
to generate time series of these parameters using trigonometric expansions due to
<span id="id40">[<a class="reference internal" href="../zzz_references_html.html#id9" title="André L. Berger. Long-term variations of daily insolation and quaternary climatic changes. Journal of the Atmospheric Sciences, 35(12):2362–2367, dec 1978. doi:10.1175/1520-0469(1978)035&lt;2362:ltvodi&gt;2.0.co;2.">161</a>]</span> with corrections made by the authors of the GISS GCM ModelE
(expansion coefficients used in <code class="docutils literal notranslate"><span class="pre">orbital_parameters.py</span></code> come from the GISS ModelE
version 2.1.2). See <a class="reference external" href="https://data.giss.nasa.gov/modelE/ar5plots/srorbpar.html">https://data.giss.nasa.gov/modelE/ar5plots/srorbpar.html</a> for details.</p>
<p>These expansions are considered to be valid for about 1 million years.</p>
</div>
</section>
<section id="surface-albedo">
<span id="sec-debm-simple-albedo"></span><h4><a class="toc-backref" href="#id53">Surface albedo</a><a class="headerlink" href="#surface-albedo" title="Permalink to this headline">¶</a></h4>
<p>To capture melt processes driven by changes in albedo without requiring a more
sophisticated surface process model (including the firn layer, for example), dEBM-simple
assumes that the surface albedo is a piecewise linear function of the modeled melt rate.</p>
<div class="math notranslate nohighlight" id="equation-eq-debm-surface-albedo">
<span class="eqno">(49)<a class="headerlink" href="#equation-eq-debm-surface-albedo" title="Permalink to this equation">¶</a></span>\[\alpha = \max\left( \alpha_{\text{max}} + \alpha_{s} \cdot M, \alpha_{\text{min}}\right).\]</div>
<p>Here <span class="math notranslate nohighlight">\(M\)</span> is the estimated melt rate from the previous time step (meters liquid water
equivalent per second) and <span class="math notranslate nohighlight">\(\alpha_s\)</span> is a <em>negative</em> tuning parameter
(<a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.albedo_slope"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.debm_simple</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.albedo_slope</span></code></a>).</p>
<p>In this approach, the albedo decreases linearly with increasing melt from the maximum
value <span class="math notranslate nohighlight">\(\alpha_{\text{max}}\)</span> (the “fresh snow” albedo
<a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.albedo_max"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.debm_simple</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.albedo_max</span></code></a>) for regions with no melting to the minimum value
<span class="math notranslate nohighlight">\(\alpha_{\text{min}}\)</span> (the “bare ice” albedo <a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.albedo_min"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.debm_simple</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.albedo_min</span></code></a>).</p>
<p>Alternatively, albedo (variable <code class="variable docutils literal notranslate"><span class="pre">surface_albedo</span></code>; no units) can be read from a file
specified using <a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.albedo_input.file"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.debm_simple</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.albedo_input</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.file</span></code></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>It is recommended to use monthly records of albedo in
<a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.albedo_input.file"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.debm_simple</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.albedo_input</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.file</span></code></a>.</p></li>
<li><p>The fresh snow albedo is also treated as a tuning parameter. Default values of
<span class="math notranslate nohighlight">\(\alpha_{\text{max}}\)</span> and <span class="math notranslate nohighlight">\(\alpha_s\)</span> were obtained by fitting this approximation to
the output of a regional climate model.</p></li>
</ul>
</div>
</section>
<section id="atmosphere-transmissivity">
<span id="sec-debm-simple-transmissivity"></span><h4><a class="toc-backref" href="#id54">Atmosphere transmissivity</a><a class="headerlink" href="#atmosphere-transmissivity" title="Permalink to this headline">¶</a></h4>
<p>dEBM-simple assumes that the transmissivity of the atmosphere <span class="math notranslate nohighlight">\(\tau_A\)</span> is a linear
function of the local surface altitude. Similarly to the albedo parameterization, the
default values of coefficients <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> below were obtained using linear regression
of an RCM output. This parameterization also relies on the assumption that no other
processes (e.g. changing mean cloud cover in a changing climate) affect <span class="math notranslate nohighlight">\(\tau_A\)</span>.</p>
<div class="math notranslate nohighlight" id="equation-eq-debm-transmissivity">
<span class="eqno">(50)<a class="headerlink" href="#equation-eq-debm-transmissivity" title="Permalink to this equation">¶</a></span>\[\tau_A = a + b\cdot z,\]</div>
<p>where <span class="math notranslate nohighlight">\(a\)</span> is set by <a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.tau_a_intercept"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.debm_simple</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.tau_a_intercept</span></code></a>, <span class="math notranslate nohighlight">\(b\)</span> is set by
<a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.tau_a_slope"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.debm_simple</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.tau_a_slope</span></code></a>, and <span class="math notranslate nohighlight">\(z\)</span> is the ice surface altitude in meters.</p>
</section>
</section>
<section id="temperature-driven-melt-contribution">
<span id="sec-debm-temperature-driven-melt"></span><h3><a class="toc-backref" href="#id55">Temperature-driven melt contribution</a><a class="headerlink" href="#temperature-driven-melt-contribution" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight" id="equation-eq-debm-temperature">
<span class="eqno">(51)<a class="headerlink" href="#equation-eq-debm-temperature" title="Permalink to this equation">¶</a></span>\[M_T = \frac{\Delta t_{\Phi}}{\Delta t \rho_{\text{w}} L_{\text{m}}}
c_1 T_\text{eff},\]</div>
<p>where</p>
<div class="math notranslate nohighlight" id="equation-eq-debm-t-eff">
<span class="eqno">(52)<a class="headerlink" href="#equation-eq-debm-t-eff" title="Permalink to this equation">¶</a></span>\[T_{\text{eff}}(T, \sigma) =
\frac{1}{\sigma \sqrt{2 \pi}}
\int_{T_{\text{pos}}}^{\infty} \xi\,
\exp\left( -\frac{(\xi - T)^2}{2 \sigma^2}  \right)\, d\xi.\]</div>
<p>The “effective temperature” <span class="math notranslate nohighlight">\(T_{\text{eff}}\)</span> is the expected value of “positive”
excursions, i.e. excursions above the positivity threshold <span class="math notranslate nohighlight">\(T_{\text{pos}}\)</span>
(<a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.positive_threshold_temp"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.debm_simple</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.positive_threshold_temp</span></code></a>, usually <span class="math notranslate nohighlight">\(0\!\phantom{|}^\circ
\text{C}\)</span>) of stochastic temperature variations added to the provided temperature
forcing.</p>
<p>Similarly to the PDD <a class="reference internal" href="#sec-surface-pdd"><span class="std std-ref">Temperature-index scheme</span></a>, these stochastic variations are assumed to
follow the normal distribution with the mean of zero and the standard deviation <span class="math notranslate nohighlight">\(\sigma\)</span>
and are used to model the effect of daily temperature variations <em>not resolved</em> by this
model either because of the temporal resolution of the provided forcing or the chosen time
step length.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The standard deviation <span class="math notranslate nohighlight">\(\sigma\)</span> of added daily variations should be treated as a tuning
parameter. The appropriate value may change depending on the application domain (for
example: Greenland vs Antarctica), the temporal resolution of the air temperature
forcing and lengths of time steps taken by dEBM-simple; see
<a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.max_evals_per_year"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.debm_simple</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.max_evals_per_year</span></code></a>.</p>
</div>
<p>Here <span class="math notranslate nohighlight">\(\sigma\)</span> can be</p>
<ul class="simple">
<li><p>constant in time and space (the default; set using <a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.std_dev"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.debm_simple</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.std_dev</span></code></a>),</p></li>
<li><p>read from a file containing the two dimensional variable <code class="variable docutils literal notranslate"><span class="pre">air_temp_sd</span></code> that can be
constant in time or time-dependent (units: <em>Kelvin</em>; specify the file name using
<a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.std_dev.file"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.debm_simple</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.std_dev</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.file</span></code></a>), or</p></li>
<li><p>parameterized as a function of air temperature <span class="math notranslate nohighlight">\(T\)</span>: <span class="math notranslate nohighlight">\(\sigma = \max(a\, (T -
T_{\text{melting}}) + b, 0)\)</span> with <span class="math notranslate nohighlight">\(T_{\text{melting}} = 273.15\)</span> Kelvin.</p></li>
</ul>
<p>These mechanisms are controlled by parameters with the prefix <code class="docutils literal notranslate"><span class="pre">surface.debm_simple.std_dev.</span></code>:</p>
<ol class="simple">
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.std_dev.file"><code class="docutils literal notranslate"><span class="pre">file</span></code></a> The file to read <code class="variable docutils literal notranslate"><span class="pre">air_temp_sd</span></code> (standard deviation of air temperature) from</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.std_dev.param.a"><code class="docutils literal notranslate"><span class="pre">param</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.a</span></code></a> (-0.15) Parameter <span class="math notranslate nohighlight">\(a\)</span> in <span class="math notranslate nohighlight">\(\sigma = \max(a\, (T - T_{\text{melting}}) + b, 0)\)</span>. Used only if <a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.std_dev.param.enabled"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.debm_simple</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.std_dev</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.param</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.enabled</span></code></a> is set to yes.</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.std_dev.param.b"><code class="docutils literal notranslate"><span class="pre">param</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.b</span></code></a> (0.66<em> Kelvin</em>) Parameter <span class="math notranslate nohighlight">\(b\)</span> in <span class="math notranslate nohighlight">\(\sigma = \max(a\, (T - T_{\text{melting}}) + b, 0)\)</span>. Used only if <a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.std_dev.param.enabled"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.debm_simple</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.std_dev</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.param</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.enabled</span></code></a> is set to yes.</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.std_dev.param.enabled"><code class="docutils literal notranslate"><span class="pre">param</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.enabled</span></code></a> (no) Parameterize standard deviation as a linear function of air temperature over ice-covered grid cells. The region of application is controlled by <a class="reference internal" href="../manual/parameters/index.html#config-geometry.ice_free_thickness_standard"><code class="docutils literal notranslate"><span class="pre">geometry</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.ice_free_thickness_standard</span></code></a>.</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.std_dev.periodic"><code class="docutils literal notranslate"><span class="pre">periodic</span></code></a> (no) If true, interpret forcing data as periodic in time</p></li>
</ol>
</section>
<section id="tuning-parameters">
<span id="sec-debm-simple-tuning"></span><h3><a class="toc-backref" href="#id56">Tuning parameters</a><a class="headerlink" href="#tuning-parameters" title="Permalink to this headline">¶</a></h3>
<p>Default values of many parameters come from <span id="id41">[<a class="reference internal" href="../zzz_references_html.html#id12" title="M. Zeitz, R. Reese, J. Beckmann, U. Krebs-Kanzow, and R. Winkelmann. Impact of the melt-albedo feedback on the future evolution of the Greenland ice sheet with PISM-dEBM-simple. The Cryosphere, 15(12):5739–5764, 2021. URL: https://tc.copernicus.org/articles/15/5739/2021/, doi:10.5194/tc-15-5739-2021.">157</a>]</span> and are appropriate for
Greenland; their values will need to change to use this model in other contexts. See Table
1 in <span id="id42">[<a class="reference internal" href="../zzz_references_html.html#id2" title="Julius Garbe, Maria Zeitz, Uta Krebs-Kanzow, and Ricarda Winkelmann. The evolution of future Antarctic surface melt using PISM-dEBM-simple. The Cryosphere, 17(11):4571–4599, nov 2023. doi:10.5194/tc-17-4571-2023.">159</a>]</span> for parameter values more appropriate in an Antarctic setting and
for the description of a calibration procedure that can be used to obtain some of these
values.</p>
<table class="colwidths-given docutils align-default" id="tab-debm-simple-tuning-parameters">
<caption><span class="caption-number">Table 37 </span><span class="caption-text">Notable tuning parameters in the order of decreasing importance</span><a class="headerlink" href="#tab-debm-simple-tuning-parameters" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 60%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Equation</p></th>
<th class="head"><p>Configuration parameters</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(c_1\)</span></p></td>
<td><p><a class="reference internal" href="#equation-eq-debm-temperature">(51)</a></p></td>
<td><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.c1"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.debm_simple</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.c1</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(c_2\)</span></p></td>
<td><p><a class="reference internal" href="#equation-eq-debm-melt-components">(45)</a></p></td>
<td><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.c2"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.debm_simple</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.c2</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(T_{\text{min}}\)</span></p></td>
<td><p><a class="reference internal" href="#equation-eq-debm-melt">(46)</a></p></td>
<td><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.melting_threshold_temp"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.debm_simple</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.melting_threshold_temp</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\sigma\)</span></p></td>
<td><p><a class="reference internal" href="#equation-eq-debm-t-eff">(52)</a></p></td>
<td><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.std_dev"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.debm_simple</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.std_dev</span></code></a> and others at the end of
<a class="reference internal" href="#sec-debm-temperature-driven-melt"><span class="std std-ref">Temperature-driven melt contribution</span></a></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\theta\)</span></p></td>
<td><p><a class="reference internal" href="#equation-eq-debm-refreeze">(44)</a></p></td>
<td><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.refreeze"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.debm_simple</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.refreeze</span></code></a>, <a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.refreeze_ice_melt"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.debm_simple</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.refreeze_ice_melt</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\alpha_{\text{max}}\)</span></p></td>
<td><p><a class="reference internal" href="#equation-eq-debm-surface-albedo">(49)</a></p></td>
<td><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.albedo_max"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.debm_simple</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.albedo_max</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\alpha_s\)</span></p></td>
<td><p><a class="reference internal" href="#equation-eq-debm-surface-albedo">(49)</a></p></td>
<td><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.albedo_slope"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.debm_simple</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.albedo_slope</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(a\)</span></p></td>
<td><p><a class="reference internal" href="#equation-eq-debm-transmissivity">(50)</a></p></td>
<td><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.tau_a_intercept"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.debm_simple</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.tau_a_intercept</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(b\)</span></p></td>
<td><p><a class="reference internal" href="#equation-eq-debm-transmissivity">(50)</a></p></td>
<td><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.tau_a_slope"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.debm_simple</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.tau_a_slope</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\Phi\)</span></p></td>
<td><p><a class="reference internal" href="#equation-eq-debm-insolation-melt">(47)</a>, <a class="reference internal" href="#equation-eq-debm-toa-insolation">(48)</a></p></td>
<td><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.debm_simple.phi"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.debm_simple</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.phi</span></code></a></p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="pik">
<span id="sec-surface-pik"></span><h2><a class="toc-backref" href="#id57">PIK</a><a class="headerlink" href="#pik" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">-surface</span> <span class="pre">pik</span></code></p>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><p><code class="variable docutils literal notranslate"><span class="pre">climatic_mass_balance</span></code> <span class="math notranslate nohighlight">\(kg / (m^{2} s)\)</span>,
<code class="variable docutils literal notranslate"><span class="pre">lat</span></code> (latitude), (degrees north)</p>
</dd>
<dt class="field-odd">C++ class</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">pism::surface::PIK</span></code></p>
</dd>
</dl>
<p>This surface model component implements the setup used in <span id="id43">[<a class="reference internal" href="../zzz_references_html.html#id304" title="M. A. Martin, R. Winkelmann, M. Haseloff, T. Albrecht, E. Bueler, C. Khroulev, and A. Levermann. The Potsdam Parallel Ice Sheet Model (PISM-PIK) –Part 2: Dynamic equilibrium simulation of the Antarctic ice sheet. The Cryosphere, 5:727–740, 2011.">52</a>]</span>. The
<code class="variable docutils literal notranslate"><span class="pre">climatic_mass_balance</span></code> is read from an input (<code class="docutils literal notranslate"><span class="pre">-i</span></code>) file; the ice surface
temperature is computed as a function of latitude (variable <code class="variable docutils literal notranslate"><span class="pre">lat</span></code>) and surface
elevation (dynamically updated by PISM). See equation (1) in <span id="id44">[<a class="reference internal" href="../zzz_references_html.html#id304" title="M. A. Martin, R. Winkelmann, M. Haseloff, T. Albrecht, E. Bueler, C. Khroulev, and A. Levermann. The Potsdam Parallel Ice Sheet Model (PISM-PIK) –Part 2: Dynamic equilibrium simulation of the Antarctic ice sheet. The Cryosphere, 5:727–740, 2011.">52</a>]</span>.</p>
</section>
<section id="scalar-temperature-offsets">
<span id="sec-surface-delta-t"></span><h2><a class="toc-backref" href="#id58">Scalar temperature offsets</a><a class="headerlink" href="#scalar-temperature-offsets" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">-surface</span> <span class="pre">...,delta_T</span></code></p>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><p><code class="variable docutils literal notranslate"><span class="pre">delta_T</span></code></p>
</dd>
<dt class="field-odd">C++ class</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">pism::surface::Delta_T</span></code></p>
</dd>
</dl>
<p>The time-dependent scalar offsets <code class="variable docutils literal notranslate"><span class="pre">delta_T</span></code> are added to <code class="variable docutils literal notranslate"><span class="pre">ice_surface_temp</span></code>
computed by a surface model.</p>
<p>Please make sure that <code class="variable docutils literal notranslate"><span class="pre">delta_T</span></code> has the units of “<code class="docutils literal notranslate"><span class="pre">Kelvin</span></code>”.</p>
<p>This modifier is identical to the corresponding atmosphere modifier, but applies offsets
at a different stage in the computation of top-surface boundary conditions needed by the
ice dynamics core.</p>
<p class="rubric">Parameters</p>
<p>Prefix: <code class="docutils literal notranslate"><span class="pre">surface.delta_T.</span></code></p>
<ol class="simple">
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.delta_T.file"><code class="docutils literal notranslate"><span class="pre">file</span></code></a> Name of the file containing temperature offsets.</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.delta_T.periodic"><code class="docutils literal notranslate"><span class="pre">periodic</span></code></a> (no) If true, interpret forcing data as periodic in time</p></li>
</ol>
</section>
<section id="adjustments-using-modeled-change-in-surface-elevation">
<span id="sec-surface-elevation-change"></span><h2><a class="toc-backref" href="#id59">Adjustments using modeled change in surface elevation</a><a class="headerlink" href="#adjustments-using-modeled-change-in-surface-elevation" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">-surface</span> <span class="pre">...,elevation_change</span></code></p>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><p><code class="variable docutils literal notranslate"><span class="pre">surface_altitude</span></code> (CF standard name),</p>
</dd>
<dt class="field-odd">C++ class</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">pism::surface::LapseRates</span></code></p>
</dd>
</dl>
<p>The <code class="docutils literal notranslate"><span class="pre">elevation_change</span></code> modifier adjusts ice-surface temperature and surface mass balance
using modeled changes in surface elevation relative to a reference elevation read from a
file.</p>
<p>The surface temperature is modified using an elevation lapse rate
<span class="math notranslate nohighlight">\(\gamma_T =\)</span> <a class="reference internal" href="../manual/parameters/index.html#config-surface.elevation_change.temperature_lapse_rate"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.elevation_change</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.temperature_lapse_rate</span></code></a>. Here</p>
<div class="math notranslate nohighlight">
\[\gamma_T = -\frac{dT}{dz}.\]</div>
<p>Two methods of adjusting the SMB are available:</p>
<ul>
<li><p>Scaling using an exponential factor</p>
<div class="math notranslate nohighlight">
\[\mathrm{SMB} = \mathrm{SMB_{input}} \cdot \exp(C \cdot \Delta T),\]</div>
<p>where <span class="math notranslate nohighlight">\(C =\)</span> <a class="reference internal" href="../manual/parameters/index.html#config-surface.elevation_change.smb.exp_factor"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.elevation_change</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.smb</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.exp_factor</span></code></a> and <span class="math notranslate nohighlight">\(\Delta T\)</span> is the
temperature difference produced by applying
<a class="reference internal" href="../manual/parameters/index.html#config-surface.elevation_change.temperature_lapse_rate"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.elevation_change</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.temperature_lapse_rate</span></code></a>.</p>
<p>This mechanisms increases the SMB by <span class="math notranslate nohighlight">\(100(\exp(C) - 1)\)</span> percent for each degree of
temperature increase.</p>
<p>To use this method, set <code class="option docutils literal notranslate"><span class="pre">-smb_adjustment</span> <span class="pre">scale</span></code>.</p>
</li>
<li><p>Elevation lapse rate for the SMB</p>
<div class="math notranslate nohighlight">
\[\mathrm{SMB} = \mathrm{SMB_{input}} - \Delta h \cdot \gamma_M,\]</div>
<p>where <span class="math notranslate nohighlight">\(\gamma_M =\)</span> <a class="reference internal" href="../manual/parameters/index.html#config-surface.elevation_change.smb.lapse_rate"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.elevation_change</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.smb</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.lapse_rate</span></code></a> and <span class="math notranslate nohighlight">\(\Delta h\)</span> is the
difference between modeled and reference surface elevations.</p>
<p>To use this method, set <code class="option docutils literal notranslate"><span class="pre">-smb_adjustment</span> <span class="pre">shift</span></code>.</p>
</li>
</ul>
<p class="rubric">Parameters</p>
<p>Prefix: <code class="docutils literal notranslate"><span class="pre">surface.elevation_change.</span></code>.</p>
<ol class="simple">
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.elevation_change.file"><code class="docutils literal notranslate"><span class="pre">file</span></code></a> Name of the file containing the reference surface elevation field (variable <code class="variable docutils literal notranslate"><span class="pre">usurf</span></code>).</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.elevation_change.periodic"><code class="docutils literal notranslate"><span class="pre">periodic</span></code></a> (no) If true, interpret forcing data as periodic in time</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.elevation_change.smb.exp_factor"><code class="docutils literal notranslate"><span class="pre">smb</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.exp_factor</span></code></a> (0<em> Kelvin-1</em>) Exponential for the surface mass balance.</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.elevation_change.smb.lapse_rate"><code class="docutils literal notranslate"><span class="pre">smb</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.lapse_rate</span></code></a> (0<em> (m / year) / km</em>) Lapse rate for the surface mass balance.</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.elevation_change.smb.method"><code class="docutils literal notranslate"><span class="pre">smb</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.method</span></code></a> (<code class="docutils literal notranslate"><span class="pre">shift</span></code>) Choose the SMB adjustment method. <code class="docutils literal notranslate"><span class="pre">scale</span></code>: use temperature-change-dependent scaling factor. <code class="docutils literal notranslate"><span class="pre">shift</span></code>: use the SMB lapse rate.</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.elevation_change.temperature_lapse_rate"><code class="docutils literal notranslate"><span class="pre">temperature_lapse_rate</span></code></a> (0<em> K / km</em>) Lapse rate for the temperature at the top of the ice.</p></li>
</ol>
</section>
<section id="mass-flux-adjustment">
<span id="sec-surface-forcing"></span><h2><a class="toc-backref" href="#id60">Mass flux adjustment</a><a class="headerlink" href="#mass-flux-adjustment" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">-surface</span> <span class="pre">...,forcing</span></code></p>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><p><code class="variable docutils literal notranslate"><span class="pre">thk</span></code> (ice thickness), <code class="variable docutils literal notranslate"><span class="pre">ftt_mask</span></code> (mask of zeros and ones; 1 where
surface mass flux is adjusted and 0 elsewhere)</p>
</dd>
<dt class="field-odd">C++ class</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">pism::surface::ForceThickness</span></code></p>
</dd>
</dl>
<p>The <code class="docutils literal notranslate"><span class="pre">forcing</span></code> modifier implements a surface mass balance adjustment mechanism which
forces the thickness of grounded ice to a target thickness distribution at the end of the
run. The idea behind this mechanism is that spinup of ice sheet models frequently requires
the surface elevation to come close to measured values at the end of a run. A simpler
alternative to accomplish this, namely option <code class="docutils literal notranslate"><span class="pre">-no_mass</span></code>, represents an unmodeled,
frequently large, violation of the mass continuity equation.</p>
<p>In more detail, let <span class="math notranslate nohighlight">\(H_{\text{tar}}\)</span> be the target thickness. Let <span class="math notranslate nohighlight">\(H\)</span> be the
time-dependent model thickness. The surface model component described here produces the
term <span class="math notranslate nohighlight">\(M\)</span> in the mass continuity equation:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial H}{\partial t} = M - S - \nabla\cdot \mathbf{q}.\]</div>
<p>(Other details of this equation do not concern us here.) The <code class="docutils literal notranslate"><span class="pre">forcing</span></code> modifier causes
<span class="math notranslate nohighlight">\(M\)</span> to be adjusted by a multiple of the difference between the target thickness and
the current thickness,</p>
<div class="math notranslate nohighlight">
\[\Delta M = \alpha (H_{\text{tar}} - H)\]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha&gt;0\)</span>. We are adding mass (<span class="math notranslate nohighlight">\(\Delta M&gt;0\)</span>) where
<span class="math notranslate nohighlight">\(H_{\text{tar}} &gt; H\)</span> and ablating where <span class="math notranslate nohighlight">\(H_{\text{tar}} &lt; H\)</span>.</p>
<p>Option <code class="option docutils literal notranslate"><span class="pre">-force_to_thickness_file</span></code> identifies the file containing the target ice
thickness field <code class="docutils literal notranslate"><span class="pre">thk</span></code> and the mask <code class="docutils literal notranslate"><span class="pre">ftt_mask</span></code>. A basic run modifying surface model
<code class="docutils literal notranslate"><span class="pre">given</span></code> would look like</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pismr -i foo.nc -surface given,forcing -force_to_thickness_file bar.nc
</pre></div>
</div>
<p>In this case <code class="docutils literal notranslate"><span class="pre">foo.nc</span></code> contains fields <code class="variable docutils literal notranslate"><span class="pre">climatic_mass_balance</span></code> and
<code class="variable docutils literal notranslate"><span class="pre">ice_surface_temp</span></code>, as normal for <code class="docutils literal notranslate"><span class="pre">-surface</span> <span class="pre">given</span></code>, and <code class="docutils literal notranslate"><span class="pre">bar.nc</span></code> contains fields
<code class="variable docutils literal notranslate"><span class="pre">thk</span></code> which will serve as the target thickness and <code class="variable docutils literal notranslate"><span class="pre">ftt_mask</span></code> which defines the
map plane area where this adjustment is applied. Option <code class="option docutils literal notranslate"><span class="pre">-force_to_thickness_alpha</span></code>
adjusts the value of <span class="math notranslate nohighlight">\(\alpha\)</span>, which has a default value specified in the
<a class="reference internal" href="../manual/parameters/index.html#sec-parameter-list"><span class="std std-ref">Configuration parameters</span></a>.</p>
<p>In addition to this one can specify a multiplicative factor <span class="math notranslate nohighlight">\(C\)</span> used in areas where
the target thickness field has less than
<code class="option docutils literal notranslate"><span class="pre">-force_to_thickness_ice_free_thickness_threshold</span></code> meters of ice;
<span class="math notranslate nohighlight">\(\alpha_{\text{ice free}} = C \times \alpha\)</span>. Use the
<code class="option docutils literal notranslate"><span class="pre">-force_to_thickness_ice_free_alpha_factor</span></code> option to set <span class="math notranslate nohighlight">\(C\)</span>.</p>
</section>
<section id="using-climate-data-anomalies">
<span id="sec-surface-anomaly"></span><h2><a class="toc-backref" href="#id61">Using climate data anomalies</a><a class="headerlink" href="#using-climate-data-anomalies" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p><code class="option docutils literal notranslate"><span class="pre">-surface</span> <span class="pre">...,anomaly</span></code></p>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><p><code class="variable docutils literal notranslate"><span class="pre">ice_surface_temp_anomaly</span></code>,
<code class="variable docutils literal notranslate"><span class="pre">climatic_mass_balance_anomaly</span></code> <span class="math notranslate nohighlight">\(kg / (m^{2} s)\)</span></p>
</dd>
<dt class="field-odd">C++ class</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">pism::surface::Anomaly</span></code></p>
</dd>
</dl>
<p>This modifier implements a spatially-variable version of <code class="docutils literal notranslate"><span class="pre">-surface</span> <span class="pre">...,delta_T</span></code> which
also applies time-dependent climatic mass balance anomalies.</p>
<p>See also <code class="docutils literal notranslate"><span class="pre">-atmosphere</span> <span class="pre">...,anomaly</span></code> (section <a class="reference internal" href="atmosphere.html#sec-atmosphere-anomaly"><span class="std std-ref">Using climate data anomalies</span></a>), which is
similar but applies anomalies at the atmosphere level.</p>
<p class="rubric">Parameters</p>
<p>Prefix: <code class="docutils literal notranslate"><span class="pre">surface.anomaly.</span></code></p>
<ol class="simple">
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.anomaly.file"><code class="docutils literal notranslate"><span class="pre">file</span></code></a> Name of the file containing climate forcing fields.</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.anomaly.periodic"><code class="docutils literal notranslate"><span class="pre">periodic</span></code></a> (no) If true, interpret forcing data as periodic in time</p></li>
</ol>
</section>
<section id="the-caching-modifier">
<span id="sec-surface-cache"></span><h2><a class="toc-backref" href="#id62">The caching modifier</a><a class="headerlink" href="#the-caching-modifier" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">-surface</span> <span class="pre">...,cache</span></code></p>
</dd>
<dt class="field-even">C++ class</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">pism::surface::Cache</span></code></p>
</dd>
<dt class="field-odd">See also</dt>
<dd class="field-odd"><p><a class="reference internal" href="ocean.html#sec-ocean-cache"><span class="std std-ref">The caching modifier</span></a></p>
</dd>
</dl>
<p>This modifier skips surface model updates, so that a surface model is called no more than
every <a class="reference internal" href="../manual/parameters/index.html#config-surface.cache.update_interval"><code class="docutils literal notranslate"><span class="pre">surface</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.cache</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.update_interval</span></code></a> 365-day “years”. A time-step of <span class="math notranslate nohighlight">\(1\)</span> year is
used every time a surface model is updated.</p>
<p>This is useful in cases when inter-annual climate variability is important, but one year
differs little from the next. (Coarse-grid paleo-climate runs, for example.)</p>
<p class="rubric">Parameters</p>
<p>Prefix: <code class="docutils literal notranslate"><span class="pre">surface.cache.</span></code></p>
<ol class="simple">
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-surface.cache.update_interval"><code class="docutils literal notranslate"><span class="pre">update_interval</span></code></a> (10<em> 365days</em>) Update interval (in 365-day years) for the <code class="docutils literal notranslate"><span class="pre">-surface</span> <span class="pre">cache</span></code> modifier.</p></li>
</ol>
</section>
<section id="preventing-grounding-line-retreat">
<span id="sec-surface-no-gl-retreat"></span><h2><a class="toc-backref" href="#id63">Preventing grounding line retreat</a><a class="headerlink" href="#preventing-grounding-line-retreat" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">-surface</span> <span class="pre">...,no_gl_retreat</span></code></p>
</dd>
<dt class="field-even">C++ class</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">pism::surface::NoGLRetreat</span></code></p>
</dd>
</dl>
<p>This modifier adjust the surface mass balance to prevent the retreat of the grounding
line. See <a class="reference internal" href="../manual/modeling-choices/subglacier/basal-strength.html#sec-tillphi-optimization"><span class="std std-ref">Till friction angle optimization</span></a> for an application.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>This modifier <em>adds mass</em> in violation of mass conservation. Save the diagnostic
<code class="variable docutils literal notranslate"><span class="pre">no_gl_retreat_smb_adjustment</span></code> to get an idea about the amount added. Note,
though, that this is an imperfect measure: it includes mass added to maintain
non-negativity of ice thickness.</p></li>
<li><p>We assume that the sea level and the bed elevation remain constant throughout the
simulation.</p></li>
<li><p>This does <em>not</em> prevent grounding line retreat caused by the thinning of the ice due
to the melt at the base. Set <a class="reference internal" href="../manual/parameters/index.html#config-geometry.update.use_basal_melt_rate"><code class="docutils literal notranslate"><span class="pre">geometry</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.update</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.use_basal_melt_rate</span></code></a> to “false”
to ensure that basal melt has no effect on the position of the grounding line</p></li>
</ul>
</div>
</section>
</section>


      <hr>
      <table style="width: 100%">
        <tr>
          <td style="text-align: left; width: 30%">
              <a class="reference internal" href="testing.html">Previous</a>
          </td>
          <td style="text-align: center; width: 30%">
              <a class="reference internal" href="index.html">Up</a>
          </td>
          <td style="text-align: right; width: 30%">
              <a class="reference internal" href="atmosphere.html">Next</a>
          </td>
        </tr>
      </table>
    </div>
  </div>
</div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/pism-logo.png" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../acknowledgements.html">Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">Installing PISM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manual/index.html">PISM User’s Manual</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Climate forcing</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="time-dependent.html">Using time-dependent forcing</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html">Examples and corresponding options</a></li>
<li class="toctree-l2"><a class="reference internal" href="testing.html">Testing if forcing data is used correctly</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Surface mass and energy process model components</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-invisible-model">The “invisible” model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reading-top-surface-boundary-conditions-from-a-file">Reading top-surface boundary conditions from a file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#elevation-dependent-temperature-and-mass-balance">Elevation-dependent temperature and mass balance</a></li>
<li class="toctree-l3"><a class="reference internal" href="#temperature-index-scheme">Temperature-index scheme</a></li>
<li class="toctree-l3"><a class="reference internal" href="#diurnal-energy-balance-model-debm-simple">Diurnal Energy Balance Model “dEBM-simple”</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pik">PIK</a></li>
<li class="toctree-l3"><a class="reference internal" href="#scalar-temperature-offsets">Scalar temperature offsets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adjustments-using-modeled-change-in-surface-elevation">Adjustments using modeled change in surface elevation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mass-flux-adjustment">Mass flux adjustment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-climate-data-anomalies">Using climate data anomalies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-caching-modifier">The caching modifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="#preventing-grounding-line-retreat">Preventing grounding line retreat</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="atmosphere.html">Atmosphere model components</a></li>
<li class="toctree-l2"><a class="reference internal" href="ocean.html">Ocean model components</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../technical/index.html">Technical notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">Contributing to PISM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authorship.html">Authorship</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zzz_references_html.html">References</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      Git revision v2.1-1-g6902d5502
      committed by Ed Bueler
      on 2023-12-20 08:38:27 -0800 |
      &copy; 2004--2023, the PISM authors.
      
    </div>
  </body>
</html>